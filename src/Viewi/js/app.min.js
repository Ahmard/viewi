function OnReady(e){var n=this;this.then=function(e,n){this.onOk=e,this.onError=n},this.catch=function(e){this.onError=e},e(function(e){n.onOk(e)},function(){n.onError()})}function Viewi(){var e=this,n={},t={},o={onViewiUrlChange:null};"img,embed,object,link,script,audio,video,style".split(",").each(function(e){t[e]=!0});var r=[],i=new Router;this.componentsUrl=VIEWI_PATH+"/components.json",this.components={};var d=document.createElement("a"),a=!1,s=function(e){return d.href=e,d.pathname},l=function(){for(var e in t)for(var n=document.getElementsByTagName(e),o=0;o<n.length;o++)r.push(n[o])},c=function(){e.components._meta.tags.split(",").each(function(e){n[e]=!0}),e.components._routes.each(function(e){i.register(e.method,e.url,e.component)}),l(),a=!0,e.go(location.href,!1)};this.start=function(){"undefined"!=typeof onViewiUrlChange&&"function"==typeof onViewiUrlChange&&(o.onViewiUrlChange=onViewiUrlChange),"undefined"!=typeof ViewiPages?(e.components=ViewiPages,c()):ajax.get(this.componentsUrl).then(function(n){e.components=n,c()}),document.addEventListener("click",function(n){n=n||window.event;var t=n.target||n.srcElement,o=t;"A"===o.parentNode.tagName&&(o=o.parentNode),"A"===o.tagName&&o.href&&0===o.href.indexOf(location.origin)&&(n.preventDefault(),e.go(o.href,!0))},!1),window.addEventListener("popstate",function(n){n.state?e.go(n.state.href,!1):e.go(location.href,!1)})},this.go=function(n,t){var r=s(n);o.onViewiUrlChange&&o.onViewiUrlChange(r);var d=i.resolve(r);if(null==d)throw"Can't resolve route for uri: "+r;t&&window.history.pushState({href:n},"",n),e.render(d.item.action,d.params)};var u=[],p=function(n,t){var o=arguments.length>2&&arguments[2],r=arguments.length>3&&arguments[3];if(n.expression){var i={call:!0,instance:t},d=["_component","app"];return(o||n.setter)&&d.push("event"),d=d.concat(u),n.setter?d.push(n.code+(n.boolean?" = event.target.checked;":" = event.target.value;")):n.raw||r?d.push("return "+n.code+";"):d.push("return app.htmlentities("+n.code+");"),i.code=n.code,i.func=Function.apply(null,d),i}return{call:!1,content:n.raw?n.content:e.decode(n.content)}},f=["template"],h=["if","else-if","else","foreach"],N=["if","else-if","else"],m=[],v=function(e,n){var t=arguments.length>2&&arguments[2],o=arguments.length>3?arguments[3]:null,r=e.children,i=[],d=!1,a=null,s={};for(var l in r){var c=r[l];if("tag"!==c.type||"slot"!==c.content)if(!c.raw&&d&&"text"===c.type&&"text"===d.type||"comment"===c.type&&"comment"===d.type){if(d.contents.push(p(c,n)),c.subs)for(var y in c.subs)H(d,c.subs[y])}else{var b=null;c.attributes&&(b=c.attributes.first(function(e){return-1!==h.indexOf(e.content)&&-1===m.indexOf(e.content)}));var x=!1;if(d={id:++g,type:c.type,contents:[p(c,n)],domNode:null,parent:o,instance:n,previousNode:a},c.raw&&(d.type="raw",d.isVirtual=!0),o&&o.condition&&(d.condition=o.condition),a&&(a.nextNode=d),a=d,"tag"===c.type&&c.expression&&(d.type="dynamic",d.componentChilds=c.children,d.isVirtual=!0),null===b&&"tag"===c.type&&-1!==f.indexOf(c.content)){var w=c.content;d.type=w,d.isVirtual=!0}if(null===b){if(m.length>0&&(m=[]),"component"===c.type&&(x=c.content),c.subs)for(var y in c.subs)H(d,c.subs[y]);if(childNodes=!1,c.children&&(childNodes=v(c,n,t,d)),c.attributes&&(d.attributes=c.attributes.where(function(e){return-1===h.indexOf(e.content)}).select(function(e){var t={},o=!e.expression&&"("===e.content[0];if(t.content=e.content,t.isAttribute=!0,t.parent=d,t.contentExpression=p(e,n),t.instance=d.instance,e.dynamic&&(t.dynamic=e.dynamic),d.scope&&(t.scope=d.scope),e.children&&(t.children=e.children.select(function(r){var i={},a="value"===e.content;if(i.contentExpression=p(r,n,o,a),"dynamic"!==d.type&&"component"!==d.type||(i.propExpression=p(r,n,null,!0),r.subs&&(i.subs=r.subs)),i.content=r.content,r.subs&&!o)for(var s in r.subs)H(t,r.subs[s]);return i})),e.subs&&!o)for(var r in e.subs)H(t,e.subs[r]);return t})),x){var E=G(x,childNodes,d.attributes);A=i.length>0?i[i.length-1]:null,_=[];E.each(function(e){!A||"text"!==A.type||"text"!==e.type||e.raw||A.raw?(e.nextNode=null,e.parent=o,e.previousNode=A,A&&(A.nextNode=e),A=e,_.push(e)):A.contents=A.contents.concat(e.contents)}),i=i.concat(_),a=i.length>0?i[i.length-1]:null}else childNodes&&("dynamic"===d.type||"raw"===d.type?d.itemChilds=childNodes:d.children=childNodes),i.push(d)}else{if(d.type=b.content,"if"===d.type&&(s={}),d.isVirtual=!0,m.push(b.content),-1!==N.indexOf(d.type)){for(var y in d.condition=b.children?p(b.children[0],n):{},s)H(d,y);if(b.children&&b.children[0].subs)for(var y in b.children[0].subs)H(d,b.children[0].subs[y]),s[b.children[0].subs[y]]=!0}var V=!1;if("foreach"===d.type&&b.children){for(var y in V=b.children[0],V.subs)H(d,V.subs[y]);d.forExpression={};var arguments=["_component","app"].concat(u);arguments.push("return "+V.forData+";"),d.forExpression.data=Function.apply(null,arguments),d.forExpression.key=V.forKey,d.forExpression.value=V.forItem,u.push(V.forKey),u.push(V.forItem),d.scope={stack:u.slice(),data:{}}}if(d.children=v({children:[c]},n,t,d),V){var C=u.indexOf(V.forKey);C>-1&&u.splice(C,1),C=u.indexOf(V.forItem),C>-1&&u.splice(C,1)}i.push(d)}}else{!0;var k=c.attributes&&c.attributes.first(function(e){return"name"===e.content}),O=0,P=function(e){return!e.attributes};k&&(O=k.children[0].content,P=function(e){return e.attributes&&e.attributes.first(function(e){return"name"===e.content&&e.children[0].content===O})});var j=!0;if(t){if(0===O){var T=t.where(function(e){return"tag"!==e.type||"slotContent"!==e.contents[0].content});if(T.length>0){j=!1;var A=i.length>0?i[i.length-1]:null,_=[];T.each(function(e){!A||"text"!==A.type||"text"!==e.type||e.raw||A.raw?(e.nextNode=null,e.parent=o,e.previousNode=A,A&&(A.nextNode=e),A=e,_.push(e)):A.contents=A.contents.concat(e.contents)}),i=i.concat(_)}}else{var I=t.first(function(e){return"tag"===e.type&&"slotContent"===e.contents[0].content&&P(e)});if(I){j=!1;var A=i.length>0?i[i.length-1]:null,_=[];I.children.each(function(e){!A||"text"!==A.type||"text"!==e.type||e.raw||A.raw?(e.nextNode=null,e.parent=o,e.previousNode=A,A&&(A.nextNode=e),A=e,_.push(e)):A.contents=A.contents.concat(e.contents)}),i=i.concat(_)}}a=i.length>0?i[i.length-1]:null}if(j){var L=v(c,n,!1,o);A=i.length>0?i[i.length-1]:null,_=[];L.each(function(e){!A||"text"!==A.type||"text"!==e.type||e.raw||A.raw?(e.nextNode=null,e.parent=o,e.previousNode=A,A&&(A.nextNode=e),A=e,_.push(e)):A.contents=A.contents.concat(e.contents)}),i=i.concat(_),a=i.length>0?i[i.length-1]:null}}}return i},y=function(n,t,o){if(n)try{var r=t.content;if(t.contentExpression.call){var i=[t.instance,e];if(t.scope)for(var d in t.scope.stack)i.push(t.scope.data[t.scope.stack[d]]);if(r=t.contentExpression.func.apply(null,i),t.latestValue&&t.latestValue!==r&&(n.removeAttribute(t.latestValue),t.listeners&&t.latestValue in t.listeners)){var s=t.latestValue.substring(1,t.latestValue.length-1);n.removeEventListener(s,t.listeners[t.latestValue])}t.latestValue=r}if("("===r[0]){if(a&&!o)return;s=r.substring(1,r.length-1);var l=null;t.dynamic?(t.eventExpression||(t.eventExpression=p(t.dynamic,t.instance,!0)),l=t.eventExpression.func):l=t.children[0].contentExpression.func,t.listeners||(t.listeners={}),t.listeners[r]=function(n){l(t.parent.instance,e,n)},n.addEventListener(s,t.listeners[r])}else{if(o&&"value"!==r)return;var c=[];for(var u in t.children){var f=t.children[u].contentExpression;if(f.call){i=[t.instance,e];if(t.scope)for(var d in t.scope.stack)i.push(t.scope.data[t.scope.stack[d]]);c.push(f.func.apply(null,i))}else c.push(f.content)}var h=c.join("");if(n.setAttribute(r,h),"value"===r){if(a&&!o)return;n.value=h;s="input";if(t.listeners||(t.listeners={}),!t.valueExpression&&t.children.length>0){t.valueExpression=p({code:t.children[0].contentExpression.code,expression:!0,setter:!0,boolean:"checkbox"===n.getAttribute("type")},t.instance);l=t.valueExpression.func;t.listeners[s]=function(n){l(t.parent.instance,e,n)}}n.removeEventListener(s,t.listeners[s]),n.addEventListener(s,t.listeners[s])}}}catch(e){console.error(e),console.log(t.content)}},b=function(e){for(var n=e,t=!0,o=!1;!n.domNode||t;)if(t=!1,null!==n.previousNode){if(n=n.previousNode,o=!1,n.isVirtual){for(var r=n;null!==r&&!r.domNode;)r=r.isVirtual&&r.children?r.children[r.children.length-1]:null;r&&(n=r)}}else{if(null===n.parent)return null;n=n.parent,o=!0}return{itsParent:o,node:n}},g=0,x=function(o,i,d,s){if(!s&&(i.isVirtual||"text"===i.type)){for(var l=i;l.parent&&l.parent.isVirtual;)l=l.parent;for(var c=b(i),u=(c&&c.itsParent?c.node.domNode:c&&c.node.domNode.parentNode)||o,p=l;p.previousNode&&(p.previousNode.isVirtual||"text"===p.previousNode.type);)p=p.previousNode;for(var f=l;f.nextNode&&(f.nextNode.isVirtual||"text"===f.nextNode.type);)f=f.nextNode;if(p!==l||f!==l){for(var h=p,N=!0;N;)x(u,h,!0,!0),N=h!==f,h=h.nextNode;return}}if(d){var m=i.parent&&i.parent.condition,v=m&&m.value;if(m&&!v)return void j([i])}if(i.isVirtual||!i.condition||i.condition.value){var g=[];for(var w in i.contents){var A=i.contents[w];if(A.call){var _=[A.instance,e];if(i.scope)for(var I in i.scope.stack)_.push(i.scope.data[i.scope.stack[I]]);g.push(A.func.apply(null,_))}else g.push(A.content)}var L=g.join(""),R=!1,S=!1;if(i.skipIteration){i.skipIteration=!1;for(var H=i;H.isVirtual;)H=H.parent;R=H.domNode;var B=E.first(function(e,n){return e===R},!0);B&&B[0].parentNode&&(V[B[1]]=!0)}else switch(i.type){case"text":if(o.doctype){R=o.doctype;break}var U=!1,D=b(i);if(d&&null==D)return;if(!U)if(D&&"text"==D.node.type)D.node.domNode.nodeValue+=L,null!==i.domNode&&(i.domNode.parentNode.removeChild(i.domNode),i.domNode=null);else if(null!==i.domNode&&i.domNode.parentNode===o)i.domNode.nodeValue=L,R=i.domNode;else{R=document.createTextNode(L);var q=D.node.domNode.nextSibling;D.itsParent||null===q?D.itsParent?D.node.domNode.childNodes.length>0?D.node.domNode.insertBefore(R,D.node.domNode.childNodes[0]):D.node.domNode.appendChild(R):D.node.domNode.parentNode.appendChild(R):q.parentNode.insertBefore(R,q),i.domNode=R}break;case"tag":if(o.documentElement){R=o.documentElement,i.domNode=R,V[0]=!0,V[1]=!0;break}if(!a&&L in t){var M=R=document.createElement(L);if(i.domNode=R,O(M,i.children,S,s),i.attributes)for(var J in i.attributes)y(M,i.attributes[J]);var K=E.first(function(e,n){return!(n in V)&&e.isEqualNode(M)},!0);if(K){V[K[1]]=!0,i.domNode=K[0];D=b(i),q=D.node.domNode.nextSibling;D.itsParent||null===q?D.itsParent?D.node.domNode.appendChild(K[0]):D.node.domNode.parentNode.appendChild(K[0]):q.parentNode.insertBefore(K[0],q);break}if(!K&&(K=r.first(function(e){return e.isEqualNode(M)}),K)){i.domNode=K;D=b(i),q=D.node.domNode.nextSibling;D.itsParent||null===q?D.itsParent?D.node.domNode.appendChild(K):D.node.domNode.parentNode.appendChild(K):q.parentNode.insertBefore(K,q);break}}if(!a&&"head"===L){var F=E.first(function(e){return e.nodeName.toLowerCase()===L},!0);R=F[0],V[F[1]]=!0,i.domNode=R;break}var X=C?E.first(function(e,n){return e.nodeName.toLowerCase()===L&&!(n in V)},!0):null;if(X&&X[0].parentNode){if(V[X[1]]=!0,k==X[1]){R=X[0],i.domNode=R;break}X[1]in V||X[0].parentNode.removeChild(X[0])}if(R=document.createElement(L),null!==i.domNode&&i.domNode.parentNode)i.domNode.parentNode.replaceChild(R,i.domNode),i.children&&j(i.children);else{D=b(i);if(null==D)return;q=D.node.domNode.nextSibling;D.itsParent||null===q?D.itsParent?D.node.domNode.childNodes.length>0?D.node.domNode.insertBefore(R,D.node.domNode.childNodes[0]):D.node.domNode.appendChild(R):D.node.domNode.parentNode.appendChild(R):q.parentNode.insertBefore(R,q)}if(i.domNode=R,L in t&&r.push(R),i.attributes)for(var J in i.attributes)y(R,i.attributes[J]);break;case"comment":if(R=document.createComment(L),null!==i.domNode)i.domNode.parentNode.replaceChild(R,i.domNode);else{D=b(i);if(null==D)return;q=D.node.domNode.nextSibling;D.itsParent||null===q?D.itsParent?D.node.domNode.childNodes.length>0?D.node.domNode.insertBefore(R,D.node.domNode.childNodes[0]):D.node.domNode.appendChild(R):D.node.domNode.parentNode.appendChild(R):q.parentNode.insertBefore(R,q)}i.domNode=R;break;case"if":i.condition.value=i.condition.func(i.instance,e),R=o,i.parentDomNode=o,i.condition.previousValue=i.condition.value,i.topRealPreviousNode=i.parent.topRealPreviousNode||i.previousNode,S=!0;break;case"else-if":i.condition.value=!i.previousNode.condition.value&&i.condition.func(i.instance,e),i.condition.previousValue=i.previousNode.condition.value||i.condition.value,R=o,i.parentDomNode=o,i.topRealPreviousNode=i.parent.topRealPreviousNode||i.previousNode,S=!0;break;case"else":i.condition.value=!i.previousNode.condition.previousValue,R=o,i.parentDomNode=o,i.topRealPreviousNode=i.parent.topRealPreviousNode||i.previousNode,S=!0;break;case"template":R=o,S=!0;break;case"foreach":if(R=o,S=!0,R){i.itemChilds||(i.itemChilds=i.children),j(i.children),i.children=null;_=[i.instance,e];var $=i.forExpression.data.apply(null,_);$&&$.length>0&&(i.children=[]);var W=null;for(var I in $){var z={type:"template",isVirtual:!0,parent:i,previousNode:W,instance:i.instance,domNode:null,scope:{stack:i.scope.stack,data:Object.assign({},i.scope.data)}};W&&(W.nextNode=z),W=z,z.scope.data[i.forExpression.key]=I,z.scope.data[i.forExpression.value]=$[I],T(z,i.itemChilds),i.children.push(z)}}break;case"dynamic":R=o,S=!0,j(i.children),i.children=null;z={contents:i.contents,attributes:i.attributes,parent:i,previousNode:null,scope:i.scope,instance:i.instance,domNode:null};i.itemChilds&&T(z,i.itemChilds),L in n?z.type="tag":(z.type="template",z.isVirtual=!0,z.children=G(L,z.children,i.attributes),z.children.each(function(e){e.parent=z})),i.children=[z];break;case"raw":if(R=o,S=!0,i.latestHtml===L)return;i.latestHtml=L,i.rawNodes&&j(i.rawNodes),i.children=null,i.rawNodes=null;var Q=P(i);if(Q){var Y=document.createElement(Q.domNode.nodeName);if(Y.innerHTML=L,Y.childNodes.length>0){var Z=0,ee=b(i);ee.itsParent||"text"!==ee.node.type||3!==Y.childNodes[0].nodeType||(ee.node.domNode.nodeValue+=Y.childNodes[0].nodeValue,Z=1);for(var ne=[];Z<Y.childNodes.length;Z++)ne.push({domNode:Y.childNodes[Z]});q=ee.node.domNode.nextSibling;if(ne.length>0){for(w=0;w<ne.length;w++)!ee.itsParent&&q?q.parentNode.insertBefore(ne[w].domNode,q):ee.itsParent?ee.node.domNode.appendChild(ne[w].domNode):ee.node.domNode.parentNode.appendChild(ne[w].domNode);var te=ne[ne.length-1];i.children=[{type:3===te.domNode.nodeType?"text":"tag",parent:i,previousNode:null,scope:i.scope,instance:i.instance,domNode:te.domNode}],i.rawNodes=ne}}}return;default:throw new Error("Node type '"+i.type+"' is not implemented.")}R&&O(R,i.children,S,s)}},w=null,E=[],V={},C=!1,k=0,O=function(e,n,t,o){var r=w,i=E,d=V;for(var a in w=e,C&&e!==r&&(E=Array.prototype.slice.call(w.childNodes),V={}),n){var s=E.first(function(e,t){return e===n[a].domNode},!0);s&&s[0].parentNode&&(V[s[1]]=!0)}for(var a in n)k=a,x(e,n[a],t,o);w=r,E=i,V=d},P=function(e){return e.parent?e.parent.domNode?e.parent:P(e.parent):null},j=function(e,n){for(var t in e)if(e[t].children&&j(e[t].children,n),e[t].domNode&&(e[t].domNode.parentNode&&e[t].domNode.parentNode.removeChild(e[t].domNode),e[t].domNode=null),e[t].origin)for(var o in e[t].origin)e[t].origin[o].skipIteration=!1,e[t].origin[o].domNode=null,e[t].origin[o]=null},T=function(e,n){var t=null,o=n.select(function(n){var o=A(e,n);return o.parent=e,o.previousNode=t,t=o,o.previousNode&&(o.previousNode.nextNode=o),o});e.children=o},A=function(e,n){var t=Object.assign({},n);return t.scope=e.scope,t.nextNode=null,t.previousNode=null,t.domNode=null,t.scope=e.scope,n.children&&T(t,n.children),t},_=0,I=function(e){return"__id"in e||Object.defineProperty(e,"__id",{enumerable:!1,writable:!1,value:++_}),e.__id},L={},R={},S={},H=function(e,n){var t=e.isAttribute,o=t?e.parent.instance:e.instance,r=I(o);if(r in R||(R[r]={}),n in R[r]||(R[r][n]=[]),R[r][n].push(e),n in S){var i=S[n],d=i.instance,a=i.subs,s=I(d);for(var l in s in R||(R[s]={}),a){var c=a[l];c in R[s]||(R[s][c]=[]),R[s][c].push(e)}}},B=function(){for(var e in L)for(var n in L[e]){var t=L[e][n];t.isAttribute?y(t.parent.domNode,t):t.isVirtual?x(t.parentDomNode,t):x(t.domNode&&t.domNode.parentNode,t)}L={}},U=function(e){for(var n in e.subs){var t=e.subs[n],o=t.id;o in R&&t.path in R[o]&&(L[o+"_"+t.path]=R[o][t.path],setTimeout(function(){B()},0))}};this.notify=function(e,n){if(Array.isArray(e)){var t=Object.getPrototypeOf(e);t.deps&&U(t.deps)}};var D=function(e,n){var t=Object.getPrototypeOf(e),o={};return Object.defineProperty(o,"deps",{enumerable:!1,writable:!1,value:n}),Object.setPrototypeOf(o,t),Object.setPrototypeOf(e,o),e},q=function(e){var n=arguments.length>1?arguments[1]:e,t=arguments.length>2?arguments[2]:"this",o=arguments.length>3?arguments[3]:{subs:{}};if(Array.isArray(e)){D(e,o);for(var r=0;r<e.length;r++)null!==e[r]&&"object"==typeof e[r]&&q(e[r],n,t+"[key]")}else{var i=Object.keys(e);for(r=0;r<i.length;r++)J(n,t+"."+i[r],e,i[r])}return e},M=null,J=function(e,n,t,o){M=null;var r=null,i=t[o],d=!1;if(M?r=M:(r={subs:{}},d=!0),null!==i&&"object"==typeof i&&q(i,e,n,r),"function"!=typeof i){var a=I(e);r.subs[a+n]={instance:e,id:a,path:n},d&&Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:function(){return M=r,i},set:function(e){e!==i&&(U(r),i=e)}})}},K={},F=function(n,t){var o=e.components[n],r=o.dependencies,i=o.service;if(i&&n in K)return K[n];if(!r){var d=new window[n];return o.init&&d.__init(),I(d),q(d),i&&(K[n]=d),d}var arguments=[null];for(var a in r){var s=r[a],l=null;l=t&&s.argName in t?t[s.argName]:s.default?s.default:s.null?null:s.builtIn?"string"===s.name?"":0:F(s.name),arguments.push(l)}d=o.init?new window[n]:new(window[n].bind.apply(window[n],arguments));return o.init&&(arguments.shift(),d.__init.apply(d,arguments)),q(d),i&&(K[n]=d),d},X=function(e,n){var t=0,o=e.length,r=n.length;if(o==r){for(c=0;c<o;c++)if(c<r){var i=!0,d=e[c].contents&&e[c].contents.select(function(e){return e.content||e.code&&++t}).join(),a=n[c].contents&&n[c].contents.select(function(e){return e.content||e.code&&++t}).join();e[c].instance.constructor!=n[c].instance.constructor&&(i=!1),d!=a&&(i=!1);var s=e[c].attributes&&e[c].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.call&&++t||""}).join(";")||"")}).join(";"),l=n[c].attributes&&n[c].attributes.select(function(e){return(e.content||"")+(e.children&&";"+e.children.select(function(e){return e.contentExpression.content||e.contentExpression.call&&++t||""}).join(";")||"")}).join(";");s!=l&&(i=!1),i||"dynamic"===e[c].type&&"dynamic"===n[c].type?(e[c].domNode=n[c].domNode,e[c].skipIteration=!e[c].isVirtual&&!!n[c].domNode,e[c].skipIteration&&(n[c].origin||(n[c].origin={}),n[c].origin[e[c].id]=e[c]),n[c].rawNodes&&(e[c].rawNodes=n[c].rawNodes,e[c].latestHtml=n[c].latestHtml),e[c].children&&n[c].children&&X(e[c].children,n[c].children)):(n[c].domNode&&n[c].domNode.parentNode?n[c].domNode.parentNode.removeChild(n[c].domNode):n[c].isVirtual&&(e[c].previousNode&&"text"===e[c].previousNode.type&&e[c].previousNode.skipIteration&&(e[c].previousNode.skipIteration=!1,j([e[c].previousNode])),j(n[c].children)),n[c].rawNodes&&(e[c].rawNodes=n[c].rawNodes,e[c].latestHtml=n[c].latestHtml))}}else{j(n);for(var c=0;c<o;c++)e[c].skipIteration&&(e[c].skipIteration=!1,e[c].domNode=null,e[c].children&&j(e[c].children,!0))}},$=null,G=function(n,t,o,r){if(!(n in e.components))throw new Error("Component "+n+" doesn't exist.");var i=null,d=null,a=z.components.first(function(e){return e.name===n},!0);a&&(z.components.splice(a[1],1),d=a[0].build);var s=S;S={};var l=$;$=n;var c=e.components[n];if(i=i||F(n,r),o)for(var u in o){var p=o[u];if(p.content in i){var f=null,h=null;for(var N in p.children){var m=p.children[N].propExpression;if(m.call){var y=[p.instance,e];if(p.scope)for(var b in p.scope.stack)y.push(p.scope.data[p.scope.stack[b]]);h=m.func.apply(null,y),p.children[N].subs&&(S["this."+p.content]={instance:p.instance,subs:p.children[N].subs})}else h=m.content;N>0?f+=h:f=h}"true"===f?f=!0:"false"===f?f=!1:"string"!=typeof f||isNaN(f)||(f=+f),i[p.content]=f}}var g=c.hasVersions?c.versions[i.__version()]:c.nodes,x=v(g,i,t);return S=s,d&&X(x,d),$=l,W.components.push({name:n,build:x,instance:i}),x},W={name:null,nodes:null,components:[]},z={name:null,nodes:null,components:[]},Q=function(e,n){if(e.children)for(var t in e.children)e.children[t].domNode?n.push(e.children[t]):e.children[t].isVirtual&&Q(e.children[t],n)},Y=function(e,n){var t=e.domNode.nodeType===n.nodeType;if(t)if(3===e.domNode.nodeType||8==e.domNode.nodeType)t=e.domNode.nodeValue==n.nodeValue,t&&(e.domNode=n);else if(1===e.domNode.nodeType&&(t=e.domNode.nodeName==n.nodeName,t)){e.domNode;e.domNode=n;var o=0,r=0,i=n.childNodes.length,d=e.children?e.children.length:0;e.children&&(e.children[d-1].domNode&&3===e.children[d-1].domNode.nodeType&&(0==n.childNodes.length||3!==n.childNodes[i-1].nodeType)&&/^\s*$/.test(e.children[d-1].domNode.nodeValue)&&n.appendChild(e.children[d-1].domNode),e.children[0].domNode&&3===e.children[0].domNode.nodeType&&3!==n.childNodes[0].nodeType&&/^\s*$/.test(e.children[0].domNode.nodeValue)&&n.insertBefore(e.children[0].domNode,n.childNodes[0]),d=e.children.length,i=n.childNodes.length);for(var a=[],s=[],l=0;l<d;l++)e.children[l].rawNodes?s=s.concat(e.children[l].rawNodes):e.children[l].isVirtual?Q(e.children[l],s):s.push(e.children[l]);var c=s.length;for(l=0;l+r<i;l++){for(;l+o<c&&!s[l+o].domNode;)o++;if(l+o<c)if(s[l+o].type){var u=Y(s[l+o],n.childNodes[l+r]);if(!u){for(var p=!1,f=l+r+1;f<i;f++)if(p=Y(s[l+o],n.childNodes[f]),p){for(var h=l+r;h<f;h++)a.push(h);r+=f-(l+r);break}if(p)continue;e.domNode!==s[l+o].domNode.parentNode?(e.domNode.childNodes.length>l+r?e.domNode.replaceChild(s[l+o].domNode,e.domNode.childNodes[l+r]):e.domNode.appendChild(s[l+o].domNode),Y(s[l+o],n.childNodes[l+r])):a.push(l)}}else s[l+o].domNode=n.childNodes[l+r];else a.push(l+r)}if(a.length>0)for(var N=a.length-1;N>=0;N--){var m=a[N];n.removeChild(n.childNodes[m])}if(i=n.childNodes.length,i>c)for(N=i-1;N>=c;N--)n.removeChild(n.childNodes[N]);if(c>i)for(N=i;N<c;N++)s[N].domNode&&!s[N].type&&n.appendChild(s[N].domNode);if(e.attributes)for(var v in e.attributes)y(e.domNode,e.attributes[v],!0)}return t};this.render=function(e,n){if(!e)throw new Error("Component name is required.");if(!(e in this.components))throw new Error("Component "+e+" doesn't exist.");R={},$=null,z=W,W={},W.name=e,W.components=[];var t=G(e,null,null,n);W.nodes=t,window.scrollTo(0,0),C=!a;var o=a?{documentElement:document.createElement("html"),doctype:{}}:document;O(o,t,!1);var r=t[1];r||"dynamic"!==t[0].type||(r=t[0].children[0].children[1]),a&&Y(r,document.documentElement),C=!1,a=!1},this.htmlentities=function(e){return e};var Z=document.createElement("textarea");this.decode=function(e){return Z.innerHTML=e,Z.value}}var ajax={get:function(e){return new OnReady(function(n,t){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){var e=o.status;if(0===e||e>=200&&e<400){var r=o.getResponseHeader("Content-Type");0===r.indexOf("application/json")?n(JSON.parse(o.responseText)):n(o.responseText)}else t()}},o.open("GET",e,!0),o.send()})},post:function(e,n){return new OnReady(function(t,o){var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState){var e=r.status;if(0===e||e>=200&&e<400){var n=r.getResponseHeader("Content-Type");0===n.indexOf("application/json")?t(JSON.parse(r.responseText)):t(r.responseText)}else o()}},r.open("POST",e,!0),r.send(JSON.stringify(n))})}};Object.defineProperty(Array.prototype,"first",{enumerable:!1,value:function(e,n){for(var t in this){if(!e)return this[t];if(e(this[t],t))return n?[this[t],t]:this[t]}return null}}),Object.defineProperty(Array.prototype,"where",{enumerable:!1,value:function(e){var n=[];for(var t in this)e(this[t],t)&&n.push(this[t]);return n}}),Object.defineProperty(Array.prototype,"select",{enumerable:!1,value:function(e){var n=[];for(var t in this)n.push(e(this[t],t));return n}}),Object.defineProperty(Array.prototype,"each",{enumerable:!1,value:function(e){for(var n in this)e(this[n],n);return this}});var app=new Viewi,notify=app.notify;"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){app.start()}):app.start();